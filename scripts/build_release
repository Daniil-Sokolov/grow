#!/bin/bash -e

if [ -d env ]; then
  source env/bin/activate

  rm -rf build
  VERSION=`cat grow/VERSION`
  case "`uname`" in
    "Darwin")
      PLATFORM="Mac"
      ;;
    *)
      PLATFORM="`uname`"
      ;;
  esac
  pyinstaller grow.spec
  chmod +x dist/grow
  cd dist
  zip -r Grow-SDK-${PLATFORM}-${VERSION}.zip grow
  cd ..
  echo "Built: dist/Grow-SDK-${PLATFORM}-${VERSION}.zip"

  deactivate
else
  echo 'Run ./scripts/setup first.'
  exit 1
fi
